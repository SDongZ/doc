<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>使用BOOST遇到的问题</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="zh-CN" class="article"><div class="titlepage"><div><div><h2 class="title"><a name="id472366"></a>使用BOOST遇到的问题</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Xiang</span> <span class="surname">Wang</span></h3></div></div></div><hr></div><div class="toc"><p><b>目录</b></p><dl class="toc"><dt><span class="section"><a href="#id472421">使用BOOST遇到的问题</a></span></dt><dt><span class="section"><a href="#id472441">stdint.h(72): warning C4005: “INT8_MIN”: 宏重定义</a></span></dt><dt><span class="section"><a href="#id472485">BOOST编译</a></span></dt><dt><span class="section"><a href="#id472617">header.hpp : warning C4819: 该文件包含不能在当前代码页(936)中表示的字符。请将该文件保存为 Unicode 格式以防止数据丢失</a></span></dt><dt><span class="section"><a href="#id472925">LOG 宽字符版本</a></span></dt><dt><span class="section"><a href="#id473076">boost::log::keywords::file_name = log_file 指定的文件无法创建的问题</a></span></dt><dt><span class="section"><a href="#id473135">boost互斥体的用法</a></span></dt><dt><span class="section"><a href="#id473199">boost thread obj 析构 不能使 线程退出</a></span></dt><dt><span class="section"><a href="#id473181">boost智能指针的用法</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id472421"></a>使用BOOST遇到的问题</h2></div></div></div><p>使用BOOST遇到的问题</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id472441"></a>stdint.h(72): warning C4005: “INT8_MIN”: 宏重定义</h2></div></div></div><p>解决方法：在stdafx.h文件头添加 </p><pre class="programlisting">

#define _INTSAFE_H_INCLUDED_
#include &lt;stdint.h&gt;

	</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id472485"></a>BOOST编译</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">bootstrap.bat 生成BOOST构建引擎 b2.exe</li><li class="listitem">b2 --show-libraries 显示所有需要编译的库</li><li class="listitem">b2 toolset==msvc-10.0 --with-log 编译指定的库，并且指定toolset</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id472617"></a>header.hpp : warning C4819: 该文件包含不能在当前代码页(936)中表示的字符。请将该文件保存为 Unicode 格式以防止数据丢失</h2></div></div></div><p>使用notepad++ 找到非法字符并去掉, 使用正则表达式查找 [^\x00-\x7F]。我遇到的非法字符是 '’' </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id472925"></a>LOG 宽字符版本</h2></div></div></div><p>LOG 宽字符版本  BOOST_LOG(SKLog::get()) &lt;&lt; L"启动程序"; 可编译,但运行时会出错</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id473076"></a>boost::log::keywords::file_name = log_file 指定的文件无法创建的问题</h2></div></div></div><p>boost::log::keywords::file_name = log_file 指定的文件无法创建的问题</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id473135"></a>boost互斥体的用法</h2></div></div></div><p>头文件boost/thread/mutex.hpp boost::mutex m_mutex; boost::mutex::scoped_lock lock(m_mutex);</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id473199"></a>boost thread obj 析构 不能使 线程退出</h2></div></div></div><p>
线程: 是io_service::run
注意，这个智能指针析构时，也不会退出线程，用reset(),置空，也不能退出线程。
最后调用io_service::stop，来结束的。
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id473181"></a>boost智能指针的用法</h2></div></div></div><p>
下面这段代码的错在那里？
boost::scoped_ptr&lt;boost::thread&gt; m_comrev_thread;
m_comrev_thread = new boost::thread(boost::bind(&amp;CLocationDlg::ComRevThread, this));

应该这样写
this-&gt;thr.reset(new boost::thread(boost::ref(*this-&gt;proc)));
	</p></div></div></body></html>
